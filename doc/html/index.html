<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Delay: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Delay
   &#160;<span id="projectnumber">1.4.2</span>
   </div>
   <div id="projectbrief">Provides a library for managing asynchronous delays and timeouts in microcontrollers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Delay Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="https://u24.gov.ua/"><img src="https://img.shields.io/static/v1?label=Stay%20with&amp;message=Ukraine%20â™¥&amp;color=ffD700&amp;labelColor=0057B8&amp;style=flat" alt="Stay with Ukraine" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md0"></a>
Delay</h1>
<p>The <a class="el" href="classDelay.html" title="This class facilitates creating non-blocking delays and timeouts.">Delay</a> library provides the simplest tools for implementing asynchronous delays and timeouts in the runtime environment of microcontrollers.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Why Delay?</h2>
<ul>
<li><b>Non-Blocking:</b> Implement delays without freezing the rest of your code. Continue to read sensors, control motors, and more.</li>
<li><b>Easy-to-Use:</b> With a few lines of code, transform your project into a multitasking powerhouse.</li>
<li><b>Precision Timing:</b> Whether you're flashing an LED or activating a servo, do it exactly when you want to.</li>
<li><b>Event-Driven:</b> Easily build logic around asynchronous events.</li>
<li><b>Resource-Efficient:</b> Keep your microcontroller running smoothly with optimized code that won't hog your precious memory or CPU cycles.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Features</h2>
<ul>
<li>Interval-based triggering with millisecond precision.</li>
<li>Automatic and manual timer resets.</li>
<li>Counter to track the number of completed delays.</li>
<li>Advanced methods for more complex timing logic, such as even/odd checks and more.</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Theory</h2>
<p>Microcontrollers are often used in environments that require multitasking, where multiple operations or processes have to be managed simultaneously. This could be as simple as blinking two LEDs at different intervals or as complex as managing sensors, actuators, and communications all at once.</p>
<p>The delay() function is a simple and straightforward way to introduce pauses or delays in the code. While it's beginner-friendly, it's not efficient for multitasking applications. When delay() is called, it blocks the entire program, making the CPU idle and unavailable to perform other tasks. This is often referred to as "busy-waiting."</p>
<p>For example, if you use delay() to blink an LED for 500 milliseconds, you can't easily do anything else during that time period. The CPU will be stuck in that delay, unable to read sensors, communicate data, or perform any other tasks.</p>
<p>This blocking behavior severely limits the microcontroller's ability to manage multiple tasks and respond to real-time events. Therefore, delay() is often considered a bad practice for anything beyond the simplest projects.</p>
<p>For these reasons, alternative methods such as using millis() for non-blocking delays or more advanced techniques like state machines, timers, or libraries like <a class="el" href="classDelay.html" title="This class facilitates creating non-blocking delays and timeouts.">Delay</a> are recommended. These methods allow your program to multitask, making efficient use of the microcontroller's processing power.</p>
<p>For example, the simplest task is to flash two LEDs so that the first one is on and off every 500 milliseconds, the other every 750 milliseconds.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Sketch 1.</h3>
<p>Using delay().</p>
<p>It is not possible to make two LEDs blink in parallel just by using the <code>delay()</code> function without additional algorithms for checking the total delay and repeating the code.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define LED_1_PIN 12</span></div>
<div class="line"><span class="preprocessor">#define LED_2_PIN 11</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  pinMode(LED_1_PIN, OUTPUT);</div>
<div class="line">  pinMode(LED_2_PIN, OUTPUT);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  digitalWrite(LED_1_PIN, HIGH);</div>
<div class="line">  delay(500);</div>
<div class="line">  digitalWrite(LED_1_PIN, LOW);</div>
<div class="line">  delay(500);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Problem: Cannot blink LED_2_PIN in parallel with LED_1_PIN because</span></div>
<div class="line">  <span class="comment">// the delay() function is blocking the program execution. This makes</span></div>
<div class="line">  <span class="comment">// LED_1_PIN and LED_2_PIN blink sequentially instead of simultaneously.</span></div>
<div class="line"> </div>
<div class="line">  digitalWrite(LED_2_PIN, HIGH);</div>
<div class="line">  delay(750);</div>
<div class="line">  digitalWrite(LED_2_PIN, LOW);</div>
<div class="line">  delay(750);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// A total of 2500 milliseconds, during which time the LED_1_PIN should</span></div>
<div class="line">  <span class="comment">// have lit up 3 times, but only once due to blocking.</span></div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md5"></a>
Sketch 2.</h3>
<p>Using the <code>millis()</code> function can solve this problem. But it will required additional control over intervals, their manual verification and declaration of additional variables. This approach is fine for small programs, and overly complicated for large programs.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define LED_1_PIN 12</span></div>
<div class="line"><span class="preprocessor">#define LED_2_PIN 11</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> previousMillis1 = 0;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> previousMillis2 = 0;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define INTERVAL_1 500</span></div>
<div class="line"><span class="preprocessor">#define INTERVAL_2 750</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  pinMode(LED_1_PIN, OUTPUT);</div>
<div class="line">  pinMode(LED_2_PIN, OUTPUT);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> currentMillis = millis();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Non-blocking way to blink LED_1_PIN, solving the problem in Sketch 1.</span></div>
<div class="line">  <span class="keywordflow">if</span> (currentMillis - previousMillis1 &gt;= INTERVAL_1) {</div>
<div class="line">    previousMillis1 = currentMillis;</div>
<div class="line">    <span class="keywordtype">bool</span> isLow = digitalRead(LED_1_PIN) == LOW;</div>
<div class="line">    digitalWrite(LED_1_PIN, isLow ? HIGH : LOW);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Non-blocking way to blink LED_2_PIN, solving the problem in Sketch 1.</span></div>
<div class="line">  <span class="keywordflow">if</span> (currentMillis - previousMillis2 &gt;= INTERVAL_2) {</div>
<div class="line">    previousMillis2 = currentMillis;</div>
<div class="line">    <span class="keywordtype">bool</span> isLow = digitalRead(LED_2_PIN) == LOW;</div>
<div class="line">    digitalWrite(LED_2_PIN, isLow ? HIGH : LOW);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md6"></a>
Sketch 3.</h3>
<p>Using <a class="el" href="classDelay.html" title="This class facilitates creating non-blocking delays and timeouts.">Delay</a> allows you to focus on the implementation of the algorithm specifically for the application being developed, and not on delay control.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;Delay.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define LED_1_PIN 12</span></div>
<div class="line"><span class="preprocessor">#define LED_2_PIN 11</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="classDelay.html">Delay</a> led1Delay(500);</div>
<div class="line"><a class="code" href="classDelay.html">Delay</a> led2Delay(750);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  pinMode(LED_1_PIN, OUTPUT);</div>
<div class="line">  pinMode(LED_2_PIN, OUTPUT);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <span class="comment">// Non-blocking way to blink LED_1_PIN,</span></div>
<div class="line">  <span class="comment">// similar to Sketch 2 but more readable.</span></div>
<div class="line">  <span class="keywordflow">if</span> (led1Delay.isOver()) {</div>
<div class="line">    <span class="keywordtype">bool</span> isLow = digitalRead(LED_1_PIN) == LOW;</div>
<div class="line">    digitalWrite(LED_1_PIN, isLow ? HIGH : LOW);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Non-blocking way to blink LED_2_PIN,</span></div>
<div class="line">  <span class="comment">// similar to Sketch 2 but more readable.</span></div>
<div class="line">  <span class="keywordflow">if</span> (led2Delay.isOver()) {</div>
<div class="line">    <span class="keywordtype">bool</span> isLow = digitalRead(LED_2_PIN) == LOW;</div>
<div class="line">    digitalWrite(LED_2_PIN, isLow ? HIGH : LOW);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassDelay_html"><div class="ttname"><a href="classDelay.html">Delay</a></div><div class="ttdoc">This class facilitates creating non-blocking delays and timeouts.</div><div class="ttdef"><b>Definition:</b> Delay.h:34</div></div>
</div><!-- fragment --><p>In addition, the <a class="el" href="classDelay.html" title="This class facilitates creating non-blocking delays and timeouts.">Delay</a> library allows you to determine, for example, whether the ready state was reached at least once <code>isNever()</code> method; whether it is an even/odd state of readiness of <code>isEven()</code> and <code>isOdd()</code> methods; the number of times the state of readiness was reached <code>getCount()</code> method, etc. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
